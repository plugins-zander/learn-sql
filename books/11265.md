# MSSQL

使用DELETE语句删除数据
语法格式如下。

```sql

```

```
说明如下。

（1）[ TOP ( expression ) [ PERCENT ] ]：指定将要删除的任意行数或任意行的百分比。

（2）FROM子句：说明从何处删除数据。可以从以下四种类型的对象中删除数据。

① 表：由table_name指定要从其中删除数据的表名，关键字WITH指定目标表所允许的一个或多个表提示，一般情况下不需要使用WITH关键字。
② 视图：由view_name指定要从其中删除数据的视图名，注意该视图必须可以更新，并且正确引用了一个基本表。
③ OPENQUERY和OPENROWSET函数：由rowset_function_limited指定。
④ table_source：将在介绍SELECT语句时详细讨论。

（3）WHERE子句：WHERE子句为删除操作指定条件，<search_condition>给出了条件，其格式将在介绍SELECT语句时详细讨论。
若省略WHERE子句，则DELETE语句将删除所有数据。
关键字CURRENT OF说明在指定游标的当前位置完成删除操作。
关键字GLOBAL说明cursor_name指定的游标是全局游标。
游标变量必须引用允许更新的游标。cursor_variable_name是游标变量的名称。

```

```sql
【例3.18】  将PXSCJ数据库的XSB表中总学分大于52的行删除，使用如下语句：
USE PXSCJ
GO
DELETE  
	FROM XSB
	WHERE 总学分>52
GO
 【例3.19】  将PXSCJ数据库的XSB表中备注为空的行删除（实际不做操作）：
DELETE FROM XSB
	WHERE 备注 IS NULL
删除PXSCJ数据库的XSB表中的所有行（实际不做操作）：
DELETE XSB


```

使用TRUNCATE TABLE语句删除表数据

使用TRUNCATE TABLE语句将删除指定表中的所有数据，因此也称为清除表数据语句。

```sql
语法格式：
TRUNCATE TABLE  tb_name
```

使用TRUNCATE TABLE语句删除了指定表中的所有行，但表的结构及其列、约束、索引等保持不变，而新行标识所用的计数值重置为该列的初始值。如果要保留标识计数值，则要使用DELETE语句。

TRUNCATE TABLE在功能上与不带WHERE子句的DELETE语句相同，二者均删除表中的全部行；
但TRUNCATE TABLE比DELETE速度快，且使用的系统和事务日志资源少。
DELETE语句每次删除一行，并在事务日志中为所删除的每一行记录一项。
而TRUNCATE TABLE通过释放存储表数据所用的数据页来删除数据，并且只在事务日志中记录页的释放。









# 界面

当表中的某些记录不再需要时，要将其删除。在对象资源管理器中删除记录的方法是：在表数据窗口中定位需删除的记录行，单击该行最前面的黑色箭头处选择全行，右击鼠标，选择“删除”菜单项，如图所示。

![](https://raw.githubusercontent.com/ZanderZhao/images/master/img2019/20191119190651.png)

删除记录

