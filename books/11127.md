# Transact-SQL

​       SQL语句只能按照既定的顺序执行，在执行过程中不能根据某些中间结果有选择地或循环地执行某些语句块，不能像高级程序语言那样进行流程控制。为此，微软公司在SQL语言的基础上添加了流程控制语句，从而得到一种结构化程序设计语言——Transact-SQL。

　　Transact-SQL即事务SQL，也简写为T-SQL，它是微软公司对关系数据库标准语言SQL进行扩充的结果，是SQL语言的超集。Transact-SQL支持所有的标准SQL语言操作。

　　作为一种标准的关系数据库语言，SQL几乎可以在所有的关系数据库上使用。但由于Transact-SQL是微软对SQL扩充的结果，所以只有SQL Server支持Transact-SQL，而其他关系数据库（如Access、Oracle等）却不支持Transact-SQL。SQL Server已经在市场中占据了主导地位，特别是随着SQL Server 版本的不断翻新，加上微软公司的强力支撑，SQL Server的主导地位将进一步得到加强。无论是数据库管理员还是数据库应用程序开发人员，要想深入领会和掌握数据库技术，必须认真学习Transact-SQL。除了拥有SQL语言所有的功能外，Transact-SQL还具备对SQL Server数据库独特的管理功能。

> T-SQL是微软根据SQL改的语言规范，SQL Server是其实现语言规范的应用程序，MSSQL是Microsoft SQL Server的缩写

# SQL Server

SQL Server的发展史

SQL Server是一个典型的关系数据库管理系统，其最初是由Microsoft、Sybase 和Ashton-Tate三家公司共同研发，于1988年推出了第一个OS/2版本。

1993年，Microsoft推出Windows NT操作系统并将数据库产品移植到Windows NT上，此后三家公司基本上“分道扬镳”。

目前，SQL Server主要是指由Microsoft公司推出的一系列SQL Server版本。SQL Server发展迅速，最近几乎是每两年推出一个新版本。

### 1. SQL Server 6.0/6.5/7.0

1995年，Microsoft推出SQL Server 6.0版本，这是第一个完全由Microsoft公司开发的版本。
1996年，Microsoft进一步推出了SQL Server 6.5版本。该版本满足众多小型商业数据管理的应用需求，也曾风靡一时。但是由于受到以前版本在结构上的限制，SQL Server 6.5在应用中逐步暴露出它的一些缺点。

1998年，Microsoft公司经过对SQL Server的核心数据库引擎进行重新改写以后，推出了SQL Server 7.0版本。SQL Server 7.0在数据存储和数据库引擎方面发生了根本性的变化，提供了面向中小型企业应用的数据库功能支持，它是SQL Server系列中第一个得到广泛应用的SQL Server版本。


### 2. SQL Server 2000

SQL Server 2000版本继承了SQL Server 7.0 版本的优点，增加了许多更先进的功能：具有更好的可用性和可伸缩性，与相关软件集成程度高，提供了企业级的数据库功能，易于安装和部署等。它既可以在Windows 98 的膝上型电脑上运行，也支持在Windows 2000大型多处理器的服务器等多种平台上使用。

### 3. SQL Server 2005

SQL Server 2005的功能体现在两个方面：

数据管理功能，SQL Server 2005 数据库引擎为关系型数据和结构化数据提供了更安全可靠的存储功能，构建和管理用于业务的高可用和高性能的数据的应用程序；
智能数据分析功能——商业智能 (BI)，SQL Server 2005可以有效地执行大规模联机事务处理，完成数据仓库和电子商务应用等许多具有挑战性的工作，构建和部署经济有效的BI解决方案。

在SQL Server系列版本中，自从SQL Server 2005开始，其管理工具的操作界面发生根本性的变化，使得对数据库的操作变得更为简单、方便。它提供了单一集成的管理控制台——SQL Server Management Studio（SSMS）。

SSMS是对SQL Server 2000查询分析器和企业管理器的集成和扩充而形成的一种SQL Server管理工具。

通过SSMS，数据管理员可以监视和管理SQL Server数据库、Integration Services、Analysis Services、Reporting Services、Notification Services以及在数量众多的分布式服务器和数据库上的SQL Server Mobile Edition，从而简化了管理工作。

在SSMS中还可以编写和执行查询，查看服务器对象，管理对象，监视系统活动和查看联机帮助等；SSMS还提供了一个开发环境，可在其中使用 Transact-SQL、多维表达式、XML for Analysis 和 SQL Server Mobile Edition来编写、编辑和管理脚本和存储过程等。

直到目前的SQL Server 2017版本，一直沿用这种界面风格和功能。


### 4. SQL Server 2008

SQL Server 2008兼容SQL Server 2005的功能并增加了许多新的功能。将结构化、半结构化和非结构化文档的数据直接存储到数据库中，对数据进行查询、搜索、同步、报告和分析等操作，满足数据爆炸和下一代数据驱动应用程序的需求，其功能十分强大，性能较SQL Server 2005更为稳定。

### 5. SQL Server 2012

SQL Server 2012是Microsoft于2012年3月发布的新一代数据平台产品，为用户带来更多全新的体验。能够顺应云技术发展的需要，全面支持云技术，能够快速实现私有云与公有云之间数据的扩展与应用的迁移，可用于大型联机事务处理、数据仓库和电子商务等方面的数据库平台，为数据存储、数据分析提供基于云技术的解决方案，是一种全新的数据分析处理平台。



### 6. SQL Server 2014

2014年4月，Microsoft推出了SQL Server 2014版本。与其他版本相比，SQL Server 2014提供了驾驭海量数据的关键技术——in-memory增强技术。该技术能够整合云端各种数据结构，极大地增强了对云的支持，提供了全新的混合云解决方案，实现云备份和灾难恢复，大幅提升数据处理的效率，能快速处理数以百万条的记录。SQL Server 2014为大数据分析提供了一种有效的解决方案。
本书是基于SQL Server 2014版本介绍关系数据库的基本原理及其相关应用，包括关系数据库理论、数据库设计方法以及数据管理、存储、查询、分析、备份等方面的内容。我们之所以选择SQL Server 2014版本来介绍数据库原理的相关内容，是在充分考虑了当前“用户条件”允许的范围内选择了最新的SQL Server版本——SQL Server 2014。


### 7. SQL Server 2016/2017

SQL Server 2016是Microsoft数据平台历史上最大的一次跨越性发展，除了兼容SQL Server 2014版本功能以外，增强了安全性、高可用性和灾难恢复功能，是性能最高的数据仓库，提供实时运营分析、大数据简化等功能，再次简化了数据库分析方式。

SQL Server 2017同时面向Windows、Linux、macOS、以及Docker容器，用户可以在 SQL Server 平台上选择开发语言、数据类型、本地开发或云端开发以及操作系统开发等，引入了图数据处理、适应性查询、面向高级分析的R/Python集成等功能。

SQL Server 2016/2017对安装环境（包括软环境和硬环境）提出较高的要求。SQL Server 2016只支持在Windows 8及以上版本的桌面操作系统或在Windows Server 2012及以上版本的服务器操作系统上安装，但目前由于操作习惯等因素，很多用户还不适应Windows 8或更高一级操作系统版本。

本书下面MSSQL部分用SQL Server 2014标准版。








