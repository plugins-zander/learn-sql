# 常量

##  4.2 Transact-SQL常量

### 1. 字符串常量

　　**字符串常量**是由**两个单引号**来定义的，是包含在两个单引号内的字符序列。

　　这些字符包括字母数字字符（a-z、A-Z 和0-9）以及特殊字符，如感叹号(!)、at 符(@) 和数字号(#)等。

　　默认情况下，SQL Server 2014为字符串常量分配当前数据库的默认排序规则，

　　但也可以用COLLATE 子句为其指定排序规则。

 【例子】下列都是合法字符串常量：

```
'China'

'中国人民共和国'
```

 

　　如果字符串中包含一个嵌入的单引号，则需要**在该单引号前再加上一个单引号，表示转义**，这样才能定义包含单引号的字符串。

 【例子】下列包含单引号的字符串都是合法的：

```
'AbC''Dd!'        -- 表示字符串“AbC'Dd!”

'xx: 20%y%.'
```

 

 

 

　　有许多程序员习惯用双引号来定义字符串常量。但在默认情况下，SQL Server不允许使用这样的定义方式。

　　如果将QUOTED_IDENTIFIER 选项设置为OFF，则SQL Server同时支持运用双引号和单引号来定义字符串。

　　　　设置QUOTED_IDENTIFIER的方法用下列语句：

```
SET QUOTED_IDENTIFIER OFF;
```

 

　　　　在执行该语句后，QUOTED_IDENTIFIER 被设置为OFF。这时除了单引号以外，还可以用双引号来定义字符串。

 【例子】下列定义的字符串都是合法的：



```
'China'

'中国人民共和国'

'AbC''Dd!'        --  表示字符串“AbC'Dd!”

'xx: 20%y%.'

"China"

"中国人民共和国"

"AbC''Dd!"      --  表示字符串“AbC''Dd!” 

"xx: 20%y%."
```



　　注意，当用**双引号定义字符串**时，如果该字符串中包含单引号，则**不能在单引号前**再**加上另一个单引号**，否则将得到另外的一种字符串。

【例子】  'AbC''Dd!'定义的是字符串“AbC'Dd!”，而"AbC''Dd!"定义则是字符串“AbC''Dd!”。

​       SQL Server将空字符串解释为单个空格。

 

　　如果不需要用双引号来定义字符串，则只要将QUOTED_IDENTIFIER恢复为默认值ON即可。需要执行下列语句：

```
SET QUOTED_IDENTIFIER ON;
```

 

　　

　　SQL Server 2014支持Unicode字符串。Unicode字符串是指按照Unicode标准来存储的字符串。但在形式上与普通字符串相似，不同的是它前面有一个N 标识符（N 代表SQL-92 标准中的区域语言），且前缀N必须是大写字母。

   【例子】  'China'是普通的字符串常量，而N'China'则是Unicode字符串常量。

 

 

### 2. 整型常量

　　整型常量也用得很多，它是不用引号括起来且不包含小数点的数字字符串。

【例子】  2007、-14等都是整型常量。

【例子】下面是定义整型常量及对其赋值的例子：

```
DECLARE @i integer

SET @i  = 99;
```

 

 

 

### 3. 日期时间常量

　　日期时间常量通常是用字符串常量来表示，

　　但前提是字符串常量能够隐式转换为日期时间型数据，

　　　　其格式为“yyyy-mm-dd hh:mm:ss.nnn”或“yyyy/mm/dd hh:mm:ss.nnn”，

　　　　其中yyyy表示年份，第一个mm表示月份，dd表示月份中的日期，

　　　　hh表示小时，第二个mm表示分钟，ss表示秒，nnn表示毫秒。

　　　　如果“yyyy-mm-dd”缺省，则日期部分默认为1900年01月01日；

　　　　如果“hh:mm:ss.nnn”缺省，则时间部分默认为00时00分00.000秒。

  【例子】下面是一些将日期时间型常量赋给日期时间型变量的例子：



```
DECLARE @dt datetime

SET @dt = '2017-01-03 21:55:56.890'     --2017年01月03日21时55分56.890秒

SET @dt = '2017/12/03'                   --2017年01月03日0时0分0秒

SET @dt = '2017-01-03'                    --2017年01月03日0时0分0秒

SET @dt = '21:55:56.890'                    --1900年01月01日21时55分56.890秒
```



 

 

 

 

### 4. 二进制常量

　　二进制常量是用前缀为0x的十六进制数字的字符串来表示，但这些字符串不用需要使用单引号括起。

   【例子】下列是将二进制常量赋给二进制变量的例子：



```
       DECLARE @bi binary(50)

       SET @bi = 0xAE

       SET @bi = 0x12Ef

       SET @bi = 0x69048AEFDD010E

       SET @bi = 0x0
```



 

 

 

### 5. 数值型常量

　　数值型常量包括三种类型：decimal型常量、float型常量和real型常量。

　　decimal型常量是包含小数点的数字字符串，但这些字符串不需单引号括起来（定点表示）。

【例子】下面是decimal型常量的例子：

   3.14159

   -1.0

　　float型常量和real型常量都是使用科学记数法来表示（浮点表示）。

【例子】

   101.5E5

   -0.5E-2

 

 

### 6. 位常量

　　位常量使用数字0或1来表示，并且不用单引号括起来。如果使用一个大于1的数字，则该数字将转换为1。

【例子】

```
  DECLARE @b bit

  SET @b = 0;
```

 

 

### 7. 货币常量

　　货币常量是前缀为可选的小数点和可选的货币符号的数字字符串，且不用单引号括起来。SQL Server 2008不强制采用任何种类的分组规则，例如在代表货币的字符串中不允许每隔三个数字用一个逗号隔开。

​    【例子】  以下是货币常量的例子：

```
$20000.2            -- 而$20,000.2是错误的货币常量

$200
```

 

 

 

### 8. 唯一标识常量

　　这是指uniqueidentifier类型的常量，它使用字符或二进制字符串格式来指定。

【例子】

```
              '6F9619FF-8B86-D011-B42D-00C04FC964FF’

              0xff19966f868b11d0b42d00c04fc964ff
```

 

 

​        以上介绍的八种类型的常量主要运用于对变量和字段赋值、构造表达式、构造子句等。在今后的介绍中将进一步领会到它的使用方法。

 