

##  Transact-SQL常量

根据常量值的不同类型，常量分为字符串常量、整型常量、实型常量、日期时间常量、货币常量、唯一标识常量。各类常量举例说明如下。

### 1．字符串常量

字符串常量分为ASCII字符串常量和Unicode字符串常量。

#### （1）ASCII字符串常量。

ASCII字符串常量是用单引号括起来，由ASCII字符构成的符号串。

```sql
　　字符串常量是由两个单引号来定义的，是包含在两个单引号内的字符序列。
　　这些字符包括字母数字字符（a-z、A-Z 和0-9）以及特殊字符，如感叹号(!)、at 符(@) 和数字号(#)等。
　　默认情况下，SQL Server 2014为字符串常量分配当前数据库的默认排序规则，但也可以用COLLATE 子句为其指定排序规则。
　　如果字符串中包含一个嵌入的单引号，则需要在该单引号前再加上一个单引号，表示转义，这样才能定义包含单引号的字符串。
```

ASCII字符串常量举例如下：
```sql
'中国人民共和国'
'China'
'How do you!'
'O''Bbaar'    /*意思是 O'Bbaar */
/*如果单引号中的字符串包含引号，可以使用两个单引号来表示嵌入的单引号。*/
```

​	有许多程序员习惯用双引号来定义字符串常量。但在默认情况下，SQL Server不允许使用这样的定义方式。

​	如果将QUOTED_IDENTIFIER 选项设置为OFF，则SQL Server同时支持运用双引号和单引号来定义字符串。

​	设置QUOTED_IDENTIFIER的方法用下列语句：

```
SET QUOTED_IDENTIFIER OFF;
```

 	在执行该语句后，QUOTED_IDENTIFIER 被设置为OFF。这时除了单引号以外，还可以用双引号来定义字符串。

　　注意，当用**双引号定义字符串**时，如果该字符串中包含单引号，则**不能在单引号前**再**加上另一个单引号**，否则将得到另外的一种字符串。

```sql
【例子】  'AbC''Dd!'定义的是字符串“AbC'Dd!”，而"AbC''Dd!"定义则是字符串“AbC''Dd!”。
       SQL Server将空字符串解释为单个空格。 
```

　　如果不需要用双引号来定义字符串，则只要将QUOTED_IDENTIFIER恢复为默认值ON即可。需要执行下列语句：

```
SET QUOTED_IDENTIFIER ON;
```

 



#### （2）Unicode 字符串常量。

Unicode 字符串常量与ASCII字符串常量相似，但它前面有一个N标识符（N代表 SQL-92标准中的国际语言National Language），N前缀必须为大写字母。

Unicode字符串常量举例如下：
```sql
N'China '
N'How do you!'
Unicode 数据中的每个字符用两个字节存储，而每个ASCII字符用一个字节存储。
'China'是普通的字符串常量，而 N'China'则是Unicode字符串常量。
```



### 2．整型常量

按照不同表示方式，整型常量又分为二进制整型常量、十六进制整型常量和十进制整型常量。

十六进制整型常量的表示：前辍 0x 后跟十六进制数字串。

十六进制常量举例：

```sql
0xEBF
0x69048AEFDD010E
0x      					/*空十六进制常量*/
```


二进制整型常量（位常量）的表示：即数字 0 或1，并且不使用引号。如果使用一个大于 1 的数字，它将被转换为1。

```sql
  DECLARE @b bit
  SET @b = 0;
```



十进制整型常量即不带小数点的十进制数，例如，
```sql
1894
2
+145345234
-2147483648
```

### 3．实型常量（数值型常量）

　　数值型常量包括三种类型：decimal型常量、float型常量和real型常量。

实型常量有定点表示和浮点表示两种方式，举例如下。

定点表示：
```sql
1894.1204
2.0
+145345234.2234
-2147483648.10

【例子】下面是decimal型常量的例子：
   3.14159
   -1.　
   decimal型常量是包含小数点的数字字符串，但这些字符串不需单引号括起来（定点表示）。
```
浮点表示：　
```sql
101.5E5
0.5E-2
+123E-3
-12E5

　　float型常量和real型常量都是使用科学记数法来表示（浮点表示）。
【例子】
   101.5E5
   -0.5E-2
```

### 4．日期时间常量

日期时间常量：用单引号将表示日期时间的字符串括起来构成。SQL Server可以识别如下格式的日期和时间。 

字母日期格式，如'April 20, 2000'；

数字日期格式，如'4/15/1998'，'1998-04-15'；

未分隔的字符串格式，如'20001207'；

以下是时间常量的例子：
```sql
'14:30:24'
'04:24:PM'
```
以下是日期时间常量的例子：
```sql
'April 20, 2000 14:30:24'
```

　　日期时间常量通常是用字符串常量来表示，

　　但前提是字符串常量能够隐式转换为日期时间型数据，

　　　　其格式为“yyyy-mm-dd hh:mm:ss.nnn”或“yyyy/mm/dd hh:mm:ss.nnn”，

　　　　其中yyyy表示年份，第一个mm表示月份，dd表示月份中的日期，

　　　　hh表示小时，第二个mm表示分钟，ss表示秒，nnn表示毫秒。

　　　　如果“yyyy-mm-dd”缺省，则日期部分默认为1900年01月01日；

　　　　如果“hh:mm:ss.nnn”缺省，则时间部分默认为00时00分00.000秒。

```
【例子】下面是一些将日期时间型常量赋给日期时间型变量的例子：
DECLARE @dt datetime
SET @dt = '2017-01-03 21:55:56.890'     --2017年01月03日21时55分56.890秒
SET @dt = '2017/12/03'                   --2017年01月03日0时0分0秒
SET @dt = '2017-01-03'                    --2017年01月03日0时0分0秒
SET @dt = '21:55:56.890'                    --1900年01月01日21时55分56.890秒
```



 

### 5. 货币常量

money常量是以“$”作为前缀的一个整型或实型常量数据。　

货币常量是前缀为可选的小数点和可选的货币符号的数字字符串，且不用单引号括起来。SQL Server 2008不强制采用任何种类的分组规则，例如在代表货币的字符串中不允许每隔三个数字用一个逗号隔开。

下面是money常量的例子：

```sql
$12
$542023
-$45.56
+$423456.99
$20000.2            -- 而$20,000.2是错误的货币常量
```





### 6. 唯一标识常量

uniqueidentifier 常量是用于表示全局唯一标识符（GUID）值的字符串。可以使用字符串或十六进制字符串格式指定。例如，
```sql
'6F9619FF-8A86-D011-B42D-00004FC964FF'
0xff19966f868b11d0b42d00c04fc964ff
```



​        以上介绍的几种类型的常量主要运用于对变量和字段赋值、构造表达式、构造子句等。在今后的介绍中将进一步领会到它的使用方法。

 